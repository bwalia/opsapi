{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "OpsAPI Secrets Schema",
  "description": "JSON schema for environment-specific secrets used in Kubernetes deployments",
  "type": "object",
  "required": [
    "DATABASE_NAME",
    "DATABASE_HOST",
    "DATABASE_PASSWORD",
    "DATABASE_PORT",
    "DATABASE_USER",
    "JWT_SECRET_KEY",
    "KEYCLOAK_AUTH_URL",
    "KEYCLOAK_CLIENT_ID",
    "KEYCLOAK_CLIENT_SECRET",
    "KEYCLOAK_REDIRECT_URI",
    "KEYCLOAK_TOKEN_URL",
    "KEYCLOAK_USERINFO_URL",
    "LAPIS_CONFIG_LUA_FILE",
    "MINIO_ACCESS_KEY",
    "MINIO_BUCKET",
    "MINIO_ENDPOINT",
    "MINIO_SECRET_KEY",
    "MINIO_REGION",
    "NODE_API_URL",
    "OPENSSL_SECRET_KEY",
    "OPENSSL_SECRET_IV"
  ],
  "properties": {
    "DATABASE_NAME": {
      "type": "string",
      "description": "PostgreSQL database name",
      "examples": ["opsapi_prod", "opsapi_test"]
    },
    "DATABASE_HOST": {
      "type": "string",
      "description": "PostgreSQL host address",
      "examples": ["pgsql.default.svc.cluster.local"]
    },
    "DATABASE_PASSWORD": {
      "type": "string",
      "description": "PostgreSQL password",
      "minLength": 16
    },
    "DATABASE_PORT": {
      "type": "string",
      "description": "PostgreSQL port",
      "default": "5432",
      "pattern": "^[0-9]+$"
    },
    "DATABASE_USER": {
      "type": "string",
      "description": "PostgreSQL username",
      "examples": ["user-prod", "user-test"]
    },
    "JWT_SECRET_KEY": {
      "type": "string",
      "description": "JWT signing secret key (base64 encoded recommended)",
      "minLength": 32
    },
    "KEYCLOAK_AUTH_URL": {
      "type": "string",
      "description": "Keycloak authorization endpoint URL",
      "format": "uri",
      "examples": ["https://sso.example.com/realms/opsapi/protocol/openid-connect/auth"]
    },
    "KEYCLOAK_CLIENT_ID": {
      "type": "string",
      "description": "Keycloak client ID",
      "examples": ["opsapi"]
    },
    "KEYCLOAK_CLIENT_SECRET": {
      "type": "string",
      "description": "Keycloak client secret",
      "minLength": 16
    },
    "KEYCLOAK_REDIRECT_URI": {
      "type": "string",
      "description": "OAuth callback URI",
      "format": "uri",
      "examples": ["https://api.example.com/auth/callback"]
    },
    "KEYCLOAK_TOKEN_URL": {
      "type": "string",
      "description": "Keycloak token endpoint URL",
      "format": "uri"
    },
    "KEYCLOAK_USERINFO_URL": {
      "type": "string",
      "description": "Keycloak userinfo endpoint URL",
      "format": "uri"
    },
    "LAPIS_CONFIG_LUA_FILE": {
      "type": "string",
      "description": "Lapis configuration Lua file content"
    },
    "MINIO_ACCESS_KEY": {
      "type": "string",
      "description": "MinIO/S3 access key",
      "minLength": 16
    },
    "MINIO_BUCKET": {
      "type": "string",
      "description": "MinIO/S3 bucket name",
      "examples": ["opsapi-prod-pg", "opsapi-test-pg"]
    },
    "MINIO_ENDPOINT": {
      "type": "string",
      "description": "MinIO/S3 endpoint URL",
      "examples": ["https://s3.example.com"]
    },
    "MINIO_SECRET_KEY": {
      "type": "string",
      "description": "MinIO/S3 secret key",
      "minLength": 32
    },
    "MINIO_REGION": {
      "type": "string",
      "description": "MinIO/S3 region",
      "examples": ["uk-west-1", "us-east-1"]
    },
    "NODE_API_URL": {
      "type": "string",
      "description": "Node.js API base URL",
      "format": "uri"
    },
    "OPENSSL_SECRET_KEY": {
      "type": "string",
      "description": "OpenSSL encryption key (16 hex characters)",
      "pattern": "^[a-f0-9]{16}$"
    },
    "OPENSSL_SECRET_IV": {
      "type": "string",
      "description": "OpenSSL initialization vector (16 hex characters)",
      "pattern": "^[a-f0-9]{16}$"
    },
    "GOOGLE_CLIENT_ID": {
      "type": "string",
      "description": "Google OAuth client ID (optional)",
      "examples": ["123456789-abc.apps.googleusercontent.com"]
    },
    "GOOGLE_CLIENT_SECRET": {
      "type": "string",
      "description": "Google OAuth client secret (optional)"
    },
    "GOOGLE_REDIRECT_URI": {
      "type": "string",
      "description": "Google OAuth redirect URI (optional)",
      "format": "uri"
    },
    "STRIPE_SECRET_KEY": {
      "type": "string",
      "description": "Stripe secret API key (optional)",
      "pattern": "^sk_(test|live)_[a-zA-Z0-9]+$"
    },
    "STRIPE_PUBLISHABLE_KEY": {
      "type": "string",
      "description": "Stripe publishable API key (optional)",
      "pattern": "^pk_(test|live)_[a-zA-Z0-9]+$"
    },
    "STRIPE_WEBHOOK_SECRET": {
      "type": "string",
      "description": "Stripe webhook signing secret (optional)",
      "pattern": "^whsec_[a-zA-Z0-9]+$"
    },
    "NEXT_PUBLIC_API_URL": {
      "type": "string",
      "description": "Public API URL for Next.js dashboard (optional)",
      "format": "uri"
    }
  },
  "additionalProperties": false
}
